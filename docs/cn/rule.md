# 规则

节点（代理服务器）负责转发流量，规则决定使用哪个节点进行转发

## 匹配优先级
~~url-rehex类型的规则由于会影响一些性能，所以会在没有匹配到其他类型的规则后进行匹配，其他类型的规则会按照配置文件中的顺序来决定优先级，即：**排在前面的优先级高于排在后面的**；同时**本地规则 > 订阅规则 > 插件中的规则**，未匹配到任何规则后会使用Final~~

3.0.3版本后调整了一下匹配算法

- 由于一般将geoip的规则放在本地规则中，多个订阅规则中混合使用IP类型的规则，并且有部分IP类型的规则没有配置no-resolve，导致很多不必要的DNS查询，所以如果一个请求的目标地址是域名，会优先匹配域名类型的规则，若匹配到了域名类规则将不会再进行IP类规则匹配，若未匹配到域名类型的规则，则会在本地进行DNS查询，根据查询结果去匹配IP类规则；
- 除了域名和IP类型的规则有优先级，其他所有规则会按照配置文件中的顺序来决定优先级，即：**排在前面的优先级高于排在后面的**；同时**本地规则 > 订阅规则 > 插件中的规则**，未匹配到任何规则后会使用Final
